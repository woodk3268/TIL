# MySQL 스레딩 구조 & MyISAM 정리

---

## ✅ 1. MySQL의 스레드 구조

| 구분                      | 설명                                                          |
| ----------------------- | ----------------------------------------------------------- |
| **포그라운드 스레드 (사용자 스레드)** | 클라이언트 1명당 1개씩 생성되어 쿼리 실행, 메모리 기록까지 수행 (버퍼 풀, 로그 버퍼 등)       |
| **백그라운드 스레드**           | 디스크 쓰기, 로그 flush, undo 정리 등 내부 유지 작업 담당. 서버 시작 시 고정 수만큼 생성됨 |
| **스레드 캐시**              | 포그라운드 스레드만 캐시에 저장되어 재사용됨. 백그라운드 스레드는 캐시 사용하지 않음             |

---

## ✅ 2. 쓰기 작업 처리 흐름

1. 포그라운드 스레드가 데이터 변경 요청 처리
2. 변경 사항을 메모리(버퍼 풀 + 로그 버퍼)에만 기록
3. 트랜잭션 커밋 시 로그 플러시 요청 발생
4. 백그라운드 스레드가 로그 및 데이터 페이지를 디스크에 flush

📌 **읽기 작업은 즉시 응답해야 하므로 지연될 수 없고**,
**쓰기 작업은 로그에만 먼저 기록한 뒤 지연 flush 가능**

---

## ✅ 3. 사용자 스레드 = 포그라운드 스레드

* 사용자 요청을 직접 처리하는 스레드
* 쿼리 실행 및 버퍼 기록까지 담당하지만 디스크 flush는 하지 않음
* 백그라운드 스레드가 실제 쓰기 작업 담당

---

## ✅ 4. MyISAM 개요

| 항목      | 설명                                   |
| ------- | ------------------------------------ |
| 소속 DBMS | MySQL 전용                             |
| 트랜잭션    | ❌ 미지원                                |
| 로그 시스템  | ❌ 없음 (Redo/Undo 로그 없음)               |
| 동시성     | 테이블 단위 잠금, 낮음                        |
| 복구 기능   | ❌ 약함                                 |
| 장점      | 구조 단순, 읽기 성능 빠름                      |
| 파일 구조   | `.frm`(정의), `.MYD`(데이터), `.MYI`(인덱스) |

---

## ✅ 5. MyISAM에서 사용자 스레드가 쓰기까지 처리하는 이유

* 별도의 백그라운드 flush 구조가 없음
* 변경 즉시 `.MYD`, `.MYI` 파일에 직접 기록
* 트랜잭션 및 로그 시스템 부재로 구조 단순화
* 설계 당시 환경(저사양 시스템)에 맞춘 고속 실행 목적

---

## ✅ 6. MyISAM vs InnoDB 핵심 비교

| 항목     | **MyISAM**          | **InnoDB**       |
| ------ | ------------------- | ---------------- |
| 트랜잭션   | ❌ 없음                | ✅ 있음             |
| 외래 키   | ❌ 없음                | ✅ 있음             |
| 잠금     | 테이블 단위              | 레코드 단위           |
| 로그 시스템 | ❌ 없음                | ✅ Redo/Undo 로그   |
| 장애 복구  | ❌ 약함                | ✅ 강함             |
| 쓰기 처리  | 사용자 스레드가 직접 디스크에 기록 | 백그라운드 스레드가 flush |
| 읽기 성능  | 빠름                  | 안정적이고 빠름         |
| 사용 추천  | 읽기 위주, 간단한 시스템      | 실무 시스템 전반        |

---

## 💡 핵심 인사이트

* MySQL의 포그라운드 스레드는 사용자 요청을 빠르게 처리하기 위해 메모리 작업만 수행.
* 실제 디스크 반영은 백그라운드 스레드가 담당하여 I/O 병목 최소화.
* MyISAM은 단순성과 속도 중심의 설계로 사용자 스레드가 디스크 쓰기까지 담당.
* 안정성과 무결성을 요구하는 시스템에서는 InnoDB 사용이 절대적이다.


