
# 📚 삽입 SQL(Embedded SQL)

---

## ✅ 학습 주제

* 삽입 SQL(Embedded SQL)의 등장 배경과 필요성
* 일반 SQL과의 차이
* 실무 적용 사례 및 삽입 SQL의 강점
* 삽입 SQL이 생긴 이유와 프로그램 흐름 제어
* 일반 SQL의 한계와 삽입 SQL의 차별점

---

## 🧩 핵심 개념 요약

| 개념                       | 설명                                                                   |
| ------------------------ | -------------------------------------------------------------------- |
| 일반 SQL (Interactive SQL) | DBMS에 직접 SQL을 입력하여 결과를 얻는 방식. 수동 실행, 조건 분기 불가                        |
| 삽입 SQL (Embedded SQL)    | C, Java 등 일반 프로그래밍 언어 안에 SQL을 삽입하여 변수 제어, 조건문, 반복문 등과 함께 DB를 제어하는 방식 |
| Precompiler              | 삽입 SQL을 C 코드 등과 연결하여 SQL 호출 함수로 번역하는 전처리기                            |
| 바인드 변수                   | C 변수와 SQL 파라미터를 연결하여 동적 값을 SQL에서 처리하게 하는 변수                          |
| 커서(Cursor)               | SQL SELECT 결과를 하나씩 순차적으로 처리할 수 있도록 해주는 구조                            |

---

## 🛠️ 등장 배경과 이유

| 이유                               | 설명                                      |
| -------------------------------- | --------------------------------------- |
| ❌ SQL만으로는 변수 입력, 조건 분기, 반복 처리 불가 | SQL은 선언형 언어라 “어떻게”가 없음                  |
| ✅ 프로그램 흐름 제어 필요                  | 사용자 입력 → 조건 분기 → SQL 실행 → 결과 저장 → 화면 출력 |
| ✅ 성능, 제어력                        | SQL을 함수처럼 호출하면서 고성능 트랜잭션, 예외처리 가능       |
| ✅ 실시간 제어                         | ATM, POS, 생산설비 제어처럼 사용자 입력 기반 SQL 필요    |

---

## 💻 실무 적용 사례

| 분야            | 사용 이유            | 예시                   |
| ------------- | ---------------- | -------------------- |
| 금융권 (C + DB2) | 빠르고 안정적인 트랜잭션 처리 | 예금 조회, 출금 시 잔액 확인    |
| 제조 MES        | 장비 상태, 공정 제어     | 설비 상태 SELECT → 조건 처리 |
| 공공 배치 시스템     | 민원 반복 처리         | 민원 커서 열기 → 반복 FETCH  |
| 임베디드 (SQLite) | 장비 내 데이터 처리      | 센서 온도 SELECT → 조건 제어 |
| 국방 시스템        | 고정밀 시스템 연동       | 병력 추적, 실시간 DB 연동     |

---

## 🔎 일반 SQL vs 삽입 SQL

| 구분      | 일반 SQL       | 삽입 SQL              |
| ------- | ------------ | ------------------- |
| 입력 방식   | 수동 입력        | 변수에 바인딩             |
| 조건문/반복문 | 없음           | 가능 (if, loop)       |
| 다건 처리   | 불편 (서브쿼리 반복) | 커서로 반복 가능           |
| 트랜잭션 제어 | 별도 필요        | 언어에서 직접 제어          |
| 사용 위치   | DB 툴/콘솔      | 프로그램 내부 (C, Java 등) |

---

## 💡 인사이트

* **SQL은 요리법, 삽입 SQL은 주방장의 로직 컨트롤러**
* 프로그램 → 사용자 입력 받기 → SQL 실행 → 결과 반영 → 출력 = 이 흐름을 구현하려면 반드시 필요
* REST API, ORM 시대에도 **성능, 통제, 레거시 유지 보수** 측면에서 여전히 유효함

---

## 🧠 기억할 것

* `EXEC SQL SELECT ... INTO :변수` ← 변수 바인딩
* `DECLARE CURSOR`, `FETCH`, `CLOSE` ← 커서 반복 처리
* `CONNECT TO DB`, `COMMIT`, `ROLLBACK` ← 트랜잭션 제어도 삽입 SQL 내에서 가능
* 실제 동작은 **Precompiler → C → DB API** 흐름으로 번역됨

---

## 📎 참고 예제 (C 기반)

```c
EXEC SQL BEGIN DECLARE SECTION;
  char p_no[10];
  char p_name[30];
  int price;
EXEC SQL END DECLARE SECTION;

scanf("%s", p_no);

EXEC SQL SELECT 제품명, 단가
 INTO :p_name, :price
 FROM 제품
 WHERE 제품번호 = :p_no;
```


