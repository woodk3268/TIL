# ë°ì´í„° ì ‘ê·¼ ê¸°ìˆ  - Querydsl

---

## âœ… í•™ìŠµ ì£¼ì œ

* Querydslì„ í™œìš©í•œ **íƒ€ì… ì•ˆì „í•œ ë™ì  ì¿¼ë¦¬ ì‘ì„±**
* ê¸°ì¡´ JPQL/ìŠ¤í”„ë§ ë°ì´í„° JPA ë°©ì‹ì˜ í•œê³„ í•´ê²°
* `BooleanBuilder`, `BooleanExpression`ì„ í†µí•œ ì¡°ê±´ ì¡°í•©
* ì„¤ì • ë°©ë²• (Gradle + Qíƒ€ì… ìƒì„± ìë™í™”)

---

## ğŸ§© í•µì‹¬ ê°œë… ìš”ì•½

| í•­ëª©                  | ì„¤ëª…                                      |
| ------------------- | --------------------------------------- |
| `QItem`             | Querydslì´ ì»´íŒŒì¼ ì‹œ ìë™ ìƒì„±í•œ ë„ë©”ì¸ í´ë˜ìŠ¤          |
| `JPAQueryFactory`   | Querydslì—ì„œ JPQLì„ íƒ€ì… ì•ˆì „í•˜ê²Œ ìƒì„±í•˜ëŠ” íŒ©í† ë¦¬       |
| `BooleanBuilder`    | ì—¬ëŸ¬ ì¡°ê±´ì„ AND/OR ì¡°í•©ìœ¼ë¡œ ë™ì ìœ¼ë¡œ ìƒì„±              |
| `BooleanExpression` | whereì ˆ ì¡°ê±´ì‹ ëª¨ë“ˆí™” ê°€ëŠ¥                       |
| `like()`, `loe()`   | Querydslì˜ ì¡°ê±´ ë©”ì„œë“œ: like(í¬í•¨), loe(ì‘ê±°ë‚˜ ê°™ìŒ) |
| `.where(A, B)`      | null ì¡°ê±´ì€ ìë™ ë¬´ì‹œ (AND ì¡°í•©)                 |

---

## ğŸ› ï¸ ì ìš© ë‹¨ê³„ ìš”ì•½

### 1. Gradle ì„¤ì • (ìŠ¤í”„ë§ ë¶€íŠ¸ 3.x ê¸°ì¤€)

```groovy
implementation 'com.querydsl:querydsl-jpa:5.0.0:jakarta'
annotationProcessor "com.querydsl:querydsl-apt:5.0.0:jakarta"
annotationProcessor "jakarta.annotation:jakarta.annotation-api"
annotationProcessor "jakarta.persistence:jakarta.persistence-api"
```

```groovy
// Qíƒ€ì… ìƒì„± ìœ„ì¹˜ ì œê±°
clean {
  delete file('src/main/generated')
}
```

---

### 2. ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„ ì˜ˆì‹œ

```java
@Repository
@Transactional
public class JpaItemRepositoryV3 implements ItemRepository {

    private final JPAQueryFactory query;

    public JpaItemRepositoryV3(EntityManager em) {
        this.query = new JPAQueryFactory(em);
    }

    @Override
    public List<Item> findAll(ItemSearchCond cond) {
        return query
            .select(item)
            .from(item)
            .where(
                likeItemName(cond.getItemName()),
                maxPrice(cond.getMaxPrice())
            ).fetch();
    }

    private BooleanExpression likeItemName(String name) {
        return hasText(name) ? item.itemName.like("%" + name + "%") : null;
    }

    private BooleanExpression maxPrice(Integer price) {
        return price != null ? item.price.loe(price) : null;
    }
}
```

---

### 3. ì„¤ì • í´ë˜ìŠ¤

```java
@Configuration
@RequiredArgsConstructor
public class QuerydslConfig {
    private final EntityManager em;

    @Bean
    public ItemRepository itemRepository() {
        return new JpaItemRepositoryV3(em);
    }
}
```

---

## ğŸ” Querydsl vs ê¸°ì¡´ ë°©ì‹

| í•­ëª©        | JPQL / ë©”ì„œë“œ ì´ë¦„ ë°©ì‹ | Querydsl                        |
| --------- | ---------------- | ------------------------------- |
| ì»´íŒŒì¼ ì‹œì  ê²€ì¦ | X                | âœ… O                             |
| ì¿¼ë¦¬ ì¬ì‚¬ìš©    | X                | âœ… O (ë©”ì„œë“œí™” ê°€ëŠ¥)                   |
| ë™ì  ì¡°ê±´ ì²˜ë¦¬  | ë³µì¡               | âœ… `BooleanBuilder` ë˜ëŠ” `null ë¬´ì‹œ` |
| íƒ€ì… ì•ˆì „ì„±    | X (ë¬¸ìì—´)          | âœ… O                             |
| ì‹¤ë¬´ ì í•©ì„±    | ë³´ì¡°ì               | âœ… ê¸°ë³¸ ì„ íƒì§€                        |

---

## ğŸ’¡ ì¸ì‚¬ì´íŠ¸

* Querydslì€ JPAì˜ ë¶€ì¡±í•œ ë™ì  ì¿¼ë¦¬ ë¬¸ì œë¥¼ ê¹”ë”í•˜ê²Œ í•´ê²°í•˜ëŠ” **í•µì‹¬ ê¸°ìˆ **
* ì¡°ê±´ ëª¨ë“ˆí™”ë¥¼ í†µí•´ **ì½”ë“œ ì¬ì‚¬ìš©ì„± ë° í…ŒìŠ¤íŠ¸ ìš©ì´ì„± ì¦ê°€**
* Qíƒ€ì… ìë™ ìƒì„±, whereì ˆ null ë¬´ì‹œ ë“±ì˜ ê¸°ëŠ¥ ë•ë¶„ì— **ê°€ë…ì„± ë†’ì€ ì¿¼ë¦¬ ì‘ì„± ê°€ëŠ¥**
* ìŠ¤í”„ë§ ë°ì´í„° JPAì™€ Querydslì„ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ **ìƒì‚°ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± ê·¹ëŒ€í™” ê°€ëŠ¥**

