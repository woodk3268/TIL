# 물리 계층과 데이터 링크 계층
## 1. 이더넷
### 1-1. 이더넷이란?
- 이더넷은 현대 LAN, 특히 유선 LAN 환경에서 가장 대중적으로 사용되는 기술이다.
- 이더넷은 다양한 통신 매체의 규격들과 송수신되는 프레임의 형태, 프레임을 주고받는 방법 등이 정의된 네트워크 기술이다.
- 예를 들어, 컴퓨터 두 대가 정보를 주고받으려면 가장 먼저 케이블과 같은 통신 매체가 필요하다.
- 그리고 그 통신 매체를 통해 정보를 송수신하는 방법이 정해져 있어야한다.

### 1-2. 이더넷 표준
- IEEE 802.3은 이더넷 관련 표준 규격들의 집합으로, 이더넷 표준에 따라 지원되는 통신 매체의 종류와 전송 속도가 달라질 수 있다.

### 1-3. 이더넷 프레임
- 이더넷 네트워크에서 주고받는 프레임인 이더넷 프레임 형식은 정해져있다.
- 이더넷 프레임 헤더는 기본적으로 프리앰블, 수신지 MAC 주소, 송신지 MAC 주소, 타입/길이로 구성되고, 페이로드는 데이터, 트레일러는 FCS로 구성된다.

**프리앰블**
- 이더넷 프레임의 시작을 알리는 8바이트 크기의 정보이다.
- 수신자는 이 프리앰블을 통해 이더넷 프레임이 오고 있음을 알아차린다.
- 즉, 프리앰블은 송수신지 간의 동기화를 위해 사용되는 정보이다.

**수신지 MAC 주소, 송신지 MAC 주소**
- '물리적 주소'라고도 불리는 MAC 주소는 데이터 링크 계층의 핵심이다.
-  MAC 주소는 네트워크 인터페이스마다 부여되는 6바이트 길이의 주소로, LAN 내의 수신지와 송신지를 특정할 수 있다.
-  같은 네트워크 내에서 동일한 MAC 주소를 가진 기기들이 있다면 송수신지를 특정할 수 없으므로, MAC 주소는 일반적으로 고유하고 변경되지 않는 주소로써 네트워크 인터페이스마다 부여된다.

**타입/길이**
- 타입이란 이더넷 프레임이 '어떤 정보를 캡슐화했는지'를 나타내는 정보이다.
- 대표적으로 상위 계층에서 사용된 프로토콜의 이름이 명시된다.

**데이터**
- 데이터는 상위 계층에서 전달받거나 상위 계층으로 전달해야 할 내용이다.
- 일정 크기 이하의 데이터라면 크기를 맞추기 위해 패딩이라는 정보가 내부에 채워진다.

**FCS**
- 수신한 이더넷 프레임에 오류가 있는지 확인하기 위한 필드이다.

## 2. NIC와 케이블
### 2-1. NIC
- 호스트와 유무선 통신 매체를 연결하고 이러한 변환을 담당하는 네트워크 장비를 의미한다.
- NIC는 통신 매체에 흐르는 신호를 호스트가 이해하는 프레임으로 변환하거나 반대로 호스트가 이해하는 프레임을 통신 매체에 흐르는 신호로 변환한다.
- 따라서 호스트가 네트워크를 통해 송수신하는 정보는 NIC를 거치게 된다.
- 이처럼 NIC는 네트워크와의 연결점을 담당한다는 점에서 네트워크 인터페이스 역할을 수행한다.

### 2-2. 트위스티드 페어 케이블
- 트위스티드 페어 케이블은 구리 선으로 전기 신호를 주고받는 통신 매체이다.
- 그런데 본체가 구리 선이 이루어진 상태에서 전기 신호를 주고받다 보면 구리 선에 전자적 간섭이 생길 수 있다.
- 이렇게 전기 신호를 왜곡시킬 수 있는 간섭을 노이즈라고 부른다.

### 2-3. 광섬유 케이블
- 빛(광신호)을 이용해 정보를 주고받는 케이블이다.
- 빛을 이용하여 전송하기에 전기 신호를 이용하는 케이블에 비해 속도도 빠르고, 먼 거리까지 전송이 가능하다.
- 노이즈로부터 간섭받는 영향도 적다.

## 3. 허브
**주소 개념이 없는 물리 계층**
: 물리 계층에는 주소 개념이 없다. 송수신지를 특정할 수 있는 주소는 데이터 링크 계층부터 존재한다.
  물리 계층에서는 단지 호스트와 통신 매체 간의 연결과 통신 매체 상의 송수신이 이루어진다.

### 3-1. 허브
- 물리 계층의 허브는 여러 대의 호스트를 연결하는 장치이다.
- 커넥터를 연결할 수 있는 연결지점을 포트라고 한다.
- 포트에 호스트와 연결된 통신 매체를 연결할 수 있다.

### 3-2. 허브의 특징
- **첫째, 전달받은 신호를 (송신지를 제외한) 다른 모튼 포트로 그대로 다시 내보낸다.**
  - 물리 계층에서는 주소 개념이 없기에 허브는 수신지를 특정할 수 없다.
  - 따라서, 신호를 전달받으면 어떠한 조작이나 판단을 하지 않고 송신지를 제외한 모든 포트에 내보낸다.
- **둘째, 반이중 모드로 통신한다.**
  - 동시에 송수신이 불가능하다.
  - 한번에 한 방향으로만 전송할 수 있다.
 
### 3-3. 콜리전 도메인
- 한 호스트가 허브에 송신하는 동안 다른 호스트는 송신하고 싶은 것이 있어도 기다려야 한다.
- 그런데 만일 동시에 허브에 신호를 송신하면 충돌(콜리전)이 발생한다.
- 이렇게 충돌이 발생할 수 있는 영역을 콜리전 도메인이라고 한다.
- 허브에 연결된 모든 호스트는 같은 콜리전 도메인에 속한다.

### 3-4. CSMA/CD
- 반이중 이더넷 네트워크에서 충돌을 방지하는 대표적인 프로토콜이다.
- **첫째, CS는 Carrier Sense, 캐리어 감지를 의미한다.**
  - 메시지를 보내기 전에 현재 네트워크 상에서 전송 중인 것이 있는지를 먼저 확인한다.
- **둘째, MA는 Multiple Access, 다중 접근을 의미한다.**
  - 복수의 호스트가 네트워크에 접근하려는 상황을 다중 접근이라고 한다.
- **셋째, CD는 Collision Detection, 충돌 검출을 의미한다.**
  - 충돌을 감지하면 전송이 중단되고, 충돌을 검출한 호스트는 다른 이들에게 충돌이 발생했음을 알리고자 잼 신호라는 특별한 신호를 보낸다.**
 
- 정리하면, 호스트들은 메시지를 전송하기 전에 1) 먼저 현재 전송이 가능한 상태인지를 확인하고,
  2) 다른 호스트가 전송 중이지 않을 때 메시지를 전송한다.
  3) 만일 부득이하게 다수의 호스트가 접근하여 충돌이 발생하면 임의의 시간만큼 대기한 후에 다시 전송한다.

## 4. 스위치
### 4-1. 스위치 VS 허브
- 비슷한 점 : 스위치의 여러 포트에는 호스트를 연결할 수 있다.
- 차이점 : 스위치는 데이터 링크 계층의 네트워크 장비이고, 허브는 물리 계층의 네트워크 장비이다.
           스위치는 허브와 달리 MAC 주소를 학습해 특정 MAC 주소를 가진 호스트에만 프레임을 전달할 수 있고, 전이중 모드의 통신을 지원한다.

### 4-2. MAC 주소 학습
- 특정 포트와 해당 포트에 연결된 호스트의 MAC주소와의 관계를 기억하는 것을 의미한다.
- 스위치의 포트와 연결된 호스트의 MAC 주소 연관관계를 나타내는 정보를 MAC 주소 테이블이라고 부른다.

- 호스트 A,B,C,D 로 구성된 네트워크에서 호스트 A가 호스트 C로 프레임을 전송하는 상황을 가정해보자.
- 스위치는 처음에는 호스트 A,B,C,D의 MAC 주소와 연결된 포트의 연관 관계를 알지 못한다.
- 스위치가 처음 호스트 A에서 프레임을 수신하면, 프레임 내 '송신지 MAC 주소' 정보를 바탕으로 호스트 A의 MAC 주소와 연결된 포트를 MAC 주소 테이블에 저장한다.
- 이 상황에서 스위치는 마치 허브처럼 송신지 포트를 제외한 모든 포트로 프레임을 전송한다. (플러딩)
- 그 중에서 호스트 B,D는 자신과 관련이 없는 프레임을 전송받은 셈이므로 이를 폐기한다.
- 호스트 C는 스위치로 응답 프레임을 전송한다. 이 프레임의 '송신지 MAC 주소; 필드에는 호스트 C의 MAC 주소가 명시되어 있다.
- 이를 통해 스위치는 호스트 C의 MAC 주소와 연결된 포트를 알아내어 이 정보를 MAC 주소 테이블에 기록한다.
- 이제 스위치는 호스트 A와 C의 MAC 주소와 연결된 포트를 알고 있으므로 두 호스트가 프레임을 주고받을 때는 다른 포트로 프레임을 내보낼 필요가 없다.

- 플러딩 : 스위치가 수신한 프레임의 목적지 MAC 주소를 모를 때, 해당 프레임을 모든 포트로 전송하는 동작
- 필터링 : 전달받은 프레임을 어디로 내보내고 어디로 내보내지 않을지 결정하는 동작
- 포워딩 : 프레임의 목적지 MAC 주소가 MAC 테이블에 있고, 송신 포트 ≠ 수신 포트인 경우, 해당 포트로 정확하게 전달하는 동작
- 에이징 : MAC 주소 테이블에서 일정 시간 동안 사용되지 않은 주소를 제거하는 동작

## 5. VLAN(Virtual LAN)
- 한 대의 스위치로 가상의 LAN을 만드는 방법이다.
- 스위치에 연결된 호스트 중에서도 브로드캐스트 메시지를 받을 필요가 없어서 굳이 같은 네트워크(LAN)에 속할 필요가 없는 호스트가 있을 수도 있다.
- VLAN을 구성하면 한 대의 물리적 스위치라 해도 여러 대의 스위치가 있는 것처럼 논리적인 단위로 VLAN을 구획할 수 있다.
- VLAN을 구성하면 VLAN1에 속한 호스트 A,B,C,D는 서로 동일한 LAN에 있는 것처럼 인식하지만, 다른 VLAN에 속한 호스트 E,F,G,H,I는 물리적인 거리와 관계없이 다른 LAN에 있는 것처럼 인식한다.

### 5-1. 포트 기반 VLAN
- 스위치의 포트가 VLAN을 결정하는 방식이다.
- 특정 포트에 VLAN을 할당하고, 해당 포트에 호스트를 연결함으로써 VLAN에 포함시킬 수 있다.
- 한 대의 스위치만으로 포트 기반 VLAN을 나누면 포트 수가 부족해질 수 있다.
   - 예를 들어 10개의 호스트를 포트가 8개인 하나의 스위치에 연결하기는 어렵다.
   - 이럴 때 사용할 수 있는 방법이 바로 VLAN 트렁킹이다. 

**VLAN 트렁킹**
- 두 대 이상의 VLAN 스위치를 효율적으로 연결하여 확장하는 방법이다.
- 스위치 간의 통신을 위한 특별한 포트인 트렁크 포트에 VLAN 스위치를 서로 연결한다.

### 5-2. MAC 기반 VLAN
- 사전에 설정된 MAC 주소에 따라 VLAN이 결정된다.
